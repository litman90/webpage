<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Matias Andina">
<meta name="description" content="Hace rato que vengo viendo ciertas tendencias de gente que hace algo de análisis de datos con la actualidad Argentina. Por ejemplo, Daniel Schteingart comúnmente publica este tipo de análisis en diversos medios. Esto me llevó a buscar datos abiertos disponibles para jugar un rato.
En general, a mí me interesa más debatir sobre la implementación de políticas y pienso que el Poder Legislativo merece mayor atención. Siento que sobrestimamos (para bien y para mal) el poder de un Ejecutivo que es, al final del día, mucho menos determinante que aquellos que escriben las leyes según las cuales se rige el Estado." />
<meta name="keywords" content="homepage, blog, neuroscience, science, programming, freelancer, R, learning" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/2019/09/los-mismos-de-siempre/" />


    <title>
        
            Los mismos de siempre :: Matias Andina  — Home &amp; Blog
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.2ad92dc1899f3589710c8dec68a643400183a43d0b7bf38ed3e21bb2dfd96b3d.css">






<meta itemprop="name" content="Los mismos de siempre">
<meta itemprop="description" content="Hace rato que vengo viendo ciertas tendencias de gente que hace algo de análisis de datos con la actualidad Argentina. Por ejemplo, Daniel Schteingart comúnmente publica este tipo de análisis en diversos medios. Esto me llevó a buscar datos abiertos disponibles para jugar un rato.
En general, a mí me interesa más debatir sobre la implementación de políticas y pienso que el Poder Legislativo merece mayor atención. Siento que sobrestimamos (para bien y para mal) el poder de un Ejecutivo que es, al final del día, mucho menos determinante que aquellos que escriben las leyes según las cuales se rige el Estado."><meta itemprop="datePublished" content="2019-09-10T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-02-15T08:03:58-05:00" />
<meta itemprop="wordCount" content="4111"><meta itemprop="image" content="/img/m-gray.jpg"/>
<meta itemprop="keywords" content="R,learning," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/img/m-gray.jpg"/>

<meta name="twitter:title" content="Los mismos de siempre"/>
<meta name="twitter:description" content="Hace rato que vengo viendo ciertas tendencias de gente que hace algo de análisis de datos con la actualidad Argentina. Por ejemplo, Daniel Schteingart comúnmente publica este tipo de análisis en diversos medios. Esto me llevó a buscar datos abiertos disponibles para jugar un rato.
En general, a mí me interesa más debatir sobre la implementación de políticas y pienso que el Poder Legislativo merece mayor atención. Siento que sobrestimamos (para bien y para mal) el poder de un Ejecutivo que es, al final del día, mucho menos determinante que aquellos que escriben las leyes según las cuales se rige el Estado."/>








    <meta property="article:published_time" content="2019-09-10 00:00:00 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Matias Andina</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/research/">Research</a></li><li><a href="/post/">Posts</a></li><li><a href="/projects/">Projects</a></li><li><a href="/contact/">Contact</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/2019/09/los-mismos-de-siempre/">Los mismos de siempre</a></h2>

            
            
            

            <div class="post-content">
                <p>Hace rato que vengo viendo ciertas tendencias de gente que hace algo de análisis de datos con la actualidad Argentina. Por ejemplo, <a href="https://twitter.com/danyscht">Daniel Schteingart</a> comúnmente publica este tipo de análisis en diversos medios. Esto me llevó a buscar datos abiertos disponibles para jugar un rato.</p>
<p>En general, a mí me interesa más debatir sobre la implementación de políticas y pienso que el Poder Legislativo merece mayor atención. Siento que sobrestimamos (para bien y para mal) el poder de un Ejecutivo que es, al final del día, mucho menos determinante que aquellos que escriben las leyes según las cuales se rige el Estado. Exigimos representantes que nos representen.</p>
<h1 id="senadores">Senadores</h1>
<p><a href="https://es.wikipedia.org/wiki/Senado_de_la_Naci%C3%B3n_Argentina">Wikipedia</a> dice: &ldquo;El Senado es el órgano federal por excelencia del país, donde cada senador representa los intereses de su provincia.&rdquo;. Basta con leer la introducción del artículo para recordarse a uno mismo por qué es tan importante tener un Senado que funcione. Entre otras tareas sin mundanas, aparentemente el Senado tiene la potestad de &ldquo;autorizar al presidente de la Nación para que declare el estado de sitio&rdquo; y de asegurar una correcta distribución de los recursos federales. Quizás cuesta entender por qué los requisitos para ser Senador son tan bajos<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<!-- raw HTML omitted -->
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/Logo_del_Senado_de_Argentina.svg/368px-Logo_del_Senado_de_Argentina.svg.png" alt=""></p>
<!-- raw HTML omitted -->
<p>Pues bien, entonces comencemos por el Senado, que tiene, además, la base de datos más completa. Pero, antes, un pequeño repaso sobre cómo se eligen los representantes y la duración de sus mandatos.</p>
<blockquote>
<p>Elecciones. La cámara de Senadores se renueva por tercios cada dos años. Los senadores son electos directamente por el pueblo. Los mandatos de los senadores son por seis años y pueden ser reelegidos en sus funciones indefinidamente.</p>
</blockquote>
<p>Las bases de datos utilizadas en este artículo son de acceso público. La base de datos de Senadores puede encontrarse en <a href="http://www.senado.gov.ar">www.senado.gov.ar</a> y <a href="http://www.congreso.gob.ar">www.congreso.gob.ar</a>.</p>
<h2 id="senadores-por-período">Senadores por período</h2>
<p>Empecemos mirando cómo evolucionaron las bancas a lo largo de nuestra historia. Vemos un comienzo con algo de recambio, seguido de un período con bajo recambio. A partir de 1930, empezamos a ver los vaivenes de un país pendular que recae en dictaduras con disolución del Poder Legislativo. Las últimas dos dictaduras están marcadas en rojo, seguidas de un alto recambio en el número de bancas (asignación de nuevos Senadores cuando se restituye el Poder Legislativo). El otro pico que llama la atención es el 2001, máximo evento de recambio en nuestra historia. Hoy por hoy, podría decirse que gozamos de unas dos décadas de estabilidad en las instituciones, en donde vemos un recambio de entre 20 y 30 bancas regularmente.</p>
<p><!-- raw HTML omitted --></p>
<h2 id="cuánto-dura-un-período">¿Cuánto dura un período?</h2>
<p>La longitud de los mandatos ha cambiado a lo largo de la historia. Además, existieron períodos en los cuales intentar ser senador no parecía una carrera a largo término (cortesía de la inestabilidad de las instituciones argentinas durante gran parte del siglo XX).</p>
<p>Un gran número de senadores no cumplen su mandato completo, ya sea por muerte, renuncia (a veces para ocupar otro cargo) o por destitución. Afortunadamente, en las últimas décadas, la tendencia parece estabilizarse hacia la longitud de mandato designada en la ley.</p>
<p><!-- raw HTML omitted --></p>
<h2 id="quién-quiere-repetir">¿Quién quiere repetir?</h2>
<p>La permanencia de un senador &ndash; o de cualquier otro político &ndash; en el cargo es un tema de debate interesante. En primer lugar, uno esperaría que cualquier trabajador con experienca y conocimiento sobre su área sea más eficiente y productivo. En criollo, si me tengo que operar de apendicitis mañana, prefiero un médico que haya realizado 1350 cirugías de apéndice que uno que haya realizado 12<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>. Luego, si trasladamos este razonamiento a nuestras instituciones deberíamos querer que el Senado esté compuesto de políticos con muchos años de experiencia en la cámara alta.</p>
<p>El problema radica en identificar cuáles son los puestos que se parecen al del médico haciendo la misma cirugía y aquellos que no. Tomemos el ejemplo de los burócratas del Estado de carrera, los estadístas, los responsables de mantenimiento de infraestructura. Esta es la gente que hace funcionar el aparato, sin ellos, no hay implementación, no hay político que pueda hacer nada. Una cosa podría que identificarlos es que todos ellos deberían ser apolíticos y, como tales, deberían poder cumplir su labor siendo independientes del gobierno de turno<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>. Los investigadores del CONICET y los maestros también son buenos ejemplos de este tipo de empleados de Estado<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<p>En cambio, el rol de los integrantes del Poder Legislativo está contaminado por el hecho de que, entre otras cosas:</p>
<ol>
<li>Legislan su propio salario.</li>
<li>Tienen la postestad de regular actividades económicas de manera conveniente.</li>
<li>Tienen re-elección indefinida.</li>
</ol>
<p>Por supuesto, podemos sumar el cúmulo de <em>beneficios legales</em> (como canjear viáticos por dinero en efectivo y discresionalidad de presupuesto) y aquellos <em>no legales</em> (en criollo, corrupción). Pero éste no es el lugar para analizar eso, focalicemos en los períodos. Los datos mandan, así que veamos qué es lo que dicen. Históricamente, la gran mayoría de senadores no repite su cargo.</p>
<p><!-- raw HTML omitted --></p>
<h3 id="repetidores-por-su-nombre">Repetidores por su nombre</h3>
<p>Este fenómeno puede explicarse por múltiples causas. Antes de cualquier análsis, veamos quiénes son los <em>repetidores</em>.</p>
<p><!-- raw HTML omitted --></p>
<p>Acá vemos por primera vez algunos nombres que suenan más a calle o a localidad que a lo que hicieron. Pero también vemos algunos nombres bastante familiares y actuales. Recordemos que 4 o 5 mandatos son, según la duración de mandato actual, entre 24 y 30 años en el mismo puesto!</p>
<h3 id="máximos-reemplazantes">Máximos reemplazantes</h3>
<p>Una curiosidad ingenua me llevó a preguntarme cuáles son los máximos reemplaznates. Me pregunte si, quizás, existía una caja con senadores de repuesto que pudieran cumplir los roles una vez que la figurita política de turno lograba conseguir los votos.
En otras palabras: ¿Es posible que exista un grupo de senadores <em>comodín</em>? Los datos presentan una triste realidad, una en la que la historia del Poder Legislativo Argentino está contaminada por sucesivas <em>disoluciones</em>. Llamémosles por su nombre, Golpes de Estado. Aún así, hay algunos senadores que han tomado la posta como suplente en reiteradas ocasiones.</p>
<!-- raw HTML omitted -->
<h2 id="dias-en-el-poder-legislativo">Dias en el poder legislativo</h2>
<p>Quiero hacer énfasis en la cantidad de días en el poder que implica repetir mandatos. Por eso, ordené a los senadores según el número de días que estuvieron (o aún están). Esta herramienta es simplemente para facilitar la visualización de los casos más extremos.</p>
<p><!-- raw HTML omitted --></p>
<p>Sólo dos ejemplos, el resto de tarea:</p>
<p><a href="https://es.wikipedia.org/wiki/Juan_Ram%C3%B3n_Vidal">Vidal</a> fue gobernador de la provincia de Corrientes (dos veces), diputado, senador por 32 años (literalmente hasta su muerte, a los 80 años).
<a href="https://es.wikipedia.org/wiki/Eriberto_Mendoza">Mendoza</a> fue legislador provincial, diputado, gobernador de San Luis y luego senador por 27 años.</p>
<p>Independientemente de lo grandiosas o nefastas de sus contribuciones y el servicio a su País, queda claro que la carrera política les permitió perpetuarse de formas que no sólo imposibles en la mayoría de otros gremios, sino que son mucho más peligrosas para la Nación.</p>
<p>Una cosa que resulta interesante es que pareciera que existen dos tipos de senadoes. Existe un quiebre entre aquellos que se quedan 1 o 2 mandatos y los demás, que se perpetúan en el cargo al mejor estilo Julio Grondona (<code>#TodoPasa</code>).</p>
<p><!-- raw HTML omitted --></p>
<p>Es interesante que en ningún momento busqué los 10 años como punto de quiebre, este valor surgió de hacer una simple regresión partida. Podemos ver que los casos más extremos se desvían bastante de la regresión (sugiriendo un incremento aún más fuerte que uno lineal), pero me pareció una forma de simplificar el asunto: más de dos mandatos y estás para quedarte, no por un rato, para quedarte a vivir.</p>
<h2 id="esto-es-nuevo">Esto es nuevo</h2>
<p>A pesar que los ejemplos con el récord de días tienen más de un siglo, la realidad es que, desde el retorno a la democracia, el cierto grado de estabilidad institucional ha permitido que estas prácticas se exacerben.</p>
<p>En el siguiente gráfico muestra los períodos de los 60 legisladores con mayor cantidad de días en el poder. Vale recalcar que dos mandatos de 9 años te colocan muy arriba en el el ránking, mientras que necesitarías 3 mandatos completos con la nueva longitud de 6 años para llegar a la misma cantidad. Es fácil ver que, entre 1850 y 1930, existieron períodos con ciertos senadores ocupando las bancas de manera prolongada. Sin embargo, estamos hablando de un período político en donde ni siquiera se había legislado la <a href="https://es.wikipedia.org/wiki/Ley_S%C3%A1enz_Pe%C3%B1a">Ley Saenz Peña</a> o recién se había implementado. Ver tanto abuso no es sorprendente si el proceso es fundamentalmente anti-democrático y los períodos son tan largos.</p>
<p>Desde el último retorno a la democracia, un número importante de senadores se han perpetuado de manera impresionante, incluso integrando más de un partido político (ver también <a href="#color">el color de la camiseta</a>).</p>
<p><!-- raw HTML omitted --></p>
<h2 id="color">El color de la camiseta</h2>
<p>Tradicionalmente, la UCR y el partido Justicialista son los grupos más convocantes. El siguiente gráfico muestra la evolución de las bancas para cada partido.</p>
<p><!-- raw HTML omitted --></p>
<p>Además de demostrar lealtad a su partido, los senadores son representantes según su provincia. Uno esperaría que tengan fuerte arraigo y sean portavoces de las necesidades particulares de aquellos a los que representan. Esto, en gran medida, se ve reflejado en que la mayoría de senadores únicamente se presenta por una provincia. Sin embargo, hay senadores fueron electos en más de una provincia:</p>
<!-- raw HTML omitted -->
<p>Un hecho más interesante es el cambio de partido. No me queda claro si esto habla de la inestabilidad en el tiempo de los partidos o de que algunos senadores se orientan con la corriente (por ponerlo de manera políticamente correcta).</p>
<p>Los siguientes senadores ejercieron cargo representando a más de un partido:</p>
<!-- raw HTML omitted -->
<h2 id="y-luego-2001">Y luego, 2001</h2>
<h3 id="explosión-de-partidos">Explosión de partidos</h3>
<blockquote>
<p>Si esto no les gusta, hagan un partido político, ganen las elecciones y después hagan lo que quieran
&ndash; CFK, 2012</p>
</blockquote>
<p>Desde el comienzo de los tiempos, el número total de partidos registrados que lograron obtener una banca en el Senado es de 109 partidos.</p>
<!-- raw HTML omitted -->
<h4 id="ajuste-por-alianzas">Ajuste por alianzas</h4>
<p>Aún cuando ajustamos por las múltiples alianzas (los justicialistas, la UCR y las distintas formas de Kirchnerismo y PRO). Las diferencias entre antes y después del 2001 son impresionantes.</p>
<!-- raw HTML omitted -->
<p>Esta era también ve la desaparición de los partidos tradicionales y la aparición de otros<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>.</p>
<p><!-- raw HTML omitted --></p>
<h2 id="partidos-por-su-nombre">Partidos por su nombre</h2>
<p>Por pura diversión, imaginemos que queremos crear un partido político en argentina. Pero no queremos un partido cualquiera, queremos un partido que logre poner bancas en el senado. Si nos olvidamos de la política y las promesas de campaña, ¿cuáles son las palabras que deberían aparecer en el nombre para lograr nuestro cometido?</p>
<p><!-- raw HTML omitted --></p>
<p><img src="/img/senadores_wordcloud.png" alt=""></p>
<h2 id="la-red-de-partidos">La red de partidos</h2>
<p>El siguiente gráfico muestra cómo están conectados los senadores con los distintos partidos. Es interesante ver la corriente ideológica del justicialismo, desde el Peronismo hasta el Frente para la Victoria. También es bastante claro el bunker de la UCR.</p>
<p><!-- raw HTML omitted --></p>
<h1 id="diputados">Diputados</h1>
<!-- raw HTML omitted -->
<p>La base de diputados comienza en 2007-12-10. Por esto no realice análisis como el de los senadores.</p>
<p>Algunas cosas que esta base sí tiene son datos de género.</p>
<!-- raw HTML omitted -->
<p>Si bien la ley exige presencia de mujeres en las listas, aún estamos lejos de alcanzar un 50% de representación femenina.</p>
<p><!-- raw HTML omitted --></p>
<p>Un dato interesante es la fuerte presencia de partidos mayoritarios, y una cámara llena de minorías, con partidos que sólo consiguieron un representante.</p>
<p><!-- raw HTML omitted --></p>
<h2 id="código">Código</h2>
<p>Para aquellos que estén interesados en reproducir este análisis, dejo el código utilizado.</p>
<pre><code class="language-r">knitr::opts_chunk$set(comment=NA, message = FALSE, warning = FALSE)
knitr::opts_chunk$set(echo = FALSE)

my_caption = &quot;Fuente: www.congreso.gob.ar&quot;
my_twitter = &quot;Matias Andina (@NeuroMLA)&quot;

library(tidyverse)
library(readxl)
library(httr)
library(lubridate)
library(cowplot)
library(knitr)
library(kableExtra)
library(tidytext)
library(wordcloud)

diputados_file &lt;- &quot;diputados.csv&quot;

if(file.exists(diputados_file)){
  diputados &lt;- read.csv(diputados_file, stringsAsFactors = FALSE)
} else {
  diputados &lt;- readr::read_csv('https://datos.hcdn.gob.ar/dataset/a80e0fa7-d73a-4ed1-9dec-80465e368951/resource/169de2eb-465f-4007-a4c2-39a5ba4c0df3/download/diputados1.8.csv')

}
  
senadores_file &lt;- &quot;senadores.csv&quot;

if(file.exists(senadores_file)){
  senadores &lt;- read.csv(senadores_file, stringsAsFactors = FALSE)
} else {
url_senado &lt;- &quot;https://www.senado.gov.ar/micrositios/DatosAbiertos/ExportarListadoSenadoresHistorico/Excel&quot;
GET(url_senado, write_disk(tf &lt;- tempfile(fileext = &quot;.xls&quot;)))
senadores &lt;- readxl::read_excel(tf, 1L) %&gt;%
  janitor::clean_names()
unlink(tf)
  
}


# remover al senador llamado &quot;,&quot;

senadores &lt;- filter(senadores, senador != &quot;,&quot;)

senadores %&gt;%
  group_by(inicio_periodo_legal) %&gt;%
  count() %&gt;%
  ggplot(aes(ymd(inicio_periodo_legal), y=n))+
  geom_rect(data=NULL,
            xmin=ymd(&quot;1976-03-24&quot;),
            xmax=ymd(&quot;1983-12-10&quot;),
            ymin=0, ymax=Inf,
            fill='red', color=NA, alpha=0.005)+
  geom_rect(data=NULL,
            xmin=ymd(&quot;1966-06-28&quot;),
            xmax=ymd(&quot;1973-05-25&quot;),
            ymin=0, ymax=Inf,
            fill=&quot;red&quot;, color=NA, alpha=0.005)+
  geom_segment(aes(x=ymd(inicio_periodo_legal),
                   xend=ymd(inicio_periodo_legal),
                   y=0, yend=n))+
  geom_point(aes(size=n))+
  theme_bw()+
  guides(size=guide_legend(title=&quot;Bancas&quot;))+
#  scale_x_date(breaks = &quot;25 years&quot;,date_labels = &quot;%Y&quot;)+
  theme(panel.grid.major.x = element_blank(),
        legend.justification = c(0, 1),
        legend.position = c(0, 1),
        legend.box.margin=margin(c(10,10,10,10)),
        legend.direction = &quot;horizontal&quot;,
        legend.background = element_rect(fill=&quot;white&quot;,
                                         color=&quot;black&quot;,
                                         size=0.2,
                                         linetype=&quot;solid&quot;))+
  xlab(&quot;&quot;) + ylab(&quot;Bancas Renovadas&quot;)+
  labs(title = &quot;Evolución de bancas en el Senado Argentino&quot;,
       subtitle = &quot;Matias Andina (@NeuroMLA)&quot;,
       caption= &quot;Fuente: www.congreso.gob.ar&quot;)+
  NULL



senadores %&gt;%
  mutate(duracion = ymd(cese_periodo_real) - ymd(inicio_periodo_real),
         year = year(inicio_periodo_real)) %&gt;%
   mutate(cese_periodo_real = ifelse(cese_periodo_real==&quot;Sin Datos&quot;,
                                    as.character(today()),
                                    cese_periodo_real)) %&gt;% 
  group_by(year) %&gt;%
#  summarise(media = mean(duracion),
#            minimo = min(duracion),
#            maximo = max(duracion)) %&gt;%
  ggplot(aes(year, duracion))+
  geom_hline(yintercept = c(6, 9) * 365, lty=2)+
  geom_point(color=&quot;black&quot;, alpha=0.2)+
  geom_smooth(color=&quot;darkorange&quot;)+
  xlab(&quot;&quot;) + ylab(&quot;Duración (días)&quot;)+
  labs(title=&quot;Duración del mandato&quot;,
       subtitle = paste0(&quot;Cada punto es la duracion de un mandato.\nLa linea de tendencia muestra un ajuste no lineal. Las líneas punteadas muestran 6 y 9 años.\n&quot;,
                         my_twitter),
       caption = my_caption
       )

count_by_sen &lt;- senadores %&gt;%
  group_by(senador) %&gt;%
  count() %&gt;% 
  arrange(desc(n)) %&gt;%
  ungroup() %&gt;%
  mutate(rank = c(1:length(unique(senadores$senador))))


summ_repite &lt;-   count_by_sen %&gt;%
  mutate(repite = ifelse(n &gt; 1, &quot;Repite&quot;, &quot;No Repite&quot;)) %&gt;%
  count(repite) %&gt;%
  mutate(total=sum(n), percent=round(n/total*100,2))


  count_by_sen %&gt;%
  mutate(repite = ifelse(n &gt; 1, &quot;Repite&quot;, &quot;No Repite&quot;)) %&gt;%
  ggplot(aes(repite, fill=repite)) + 
  geom_bar() +
  geom_text(data=summ_repite, aes(repite, y = 50,
                                  label= paste0(n, &quot; (&quot;, percent, &quot;%)&quot;)),
            fontface=&quot;bold&quot;, color=&quot;white&quot;)+
  theme_bw() +
  xlab(&quot;&quot;) + ylab(&quot;Número de senadores&quot;)+
  theme(legend.position = &quot;none&quot;)+
  scale_fill_manual(values = c(&quot;gray30&quot;, &quot;orange&quot;))+
  labs(title=&quot;Reincidencia Legislativa&quot;,
       subtitle = paste0(&quot;Aproximadamente un 20% de los legisladores cumplieron más de un mandato.\n&quot;,my_twitter),
       caption=my_caption)


p &lt;- count_by_sen %&gt;%
     dplyr::filter(n &gt; 1) %&gt;%
     ggplot(aes(rank, n))+
     geom_point(aes(color=factor(n)))+
     ylim(0, 6)+
     scale_y_continuous(breaks = 1:5)+
     scale_color_manual(values = c(&quot;black&quot;, &quot;black&quot;, &quot;orange&quot;, &quot;red&quot;))+
     theme(legend.position = &quot;none&quot;)+
     ylab(&quot;Número de períodos&quot;)+
     xlab(&quot;Senadores según número de orden.\nRanking descendente&quot;)+
  labs(title=&quot;Repetidores por su numbre&quot;,
       subtitle = paste0(&quot;Senadores con más de un período, ordenados según el numero de períodos.\n&quot;, my_twitter),
       caption = my_caption)

  inset &lt;- dplyr::filter(count_by_sen, n &gt;= 4) %&gt;%
           mutate(col = n&gt;4) %&gt;%
    ggplot(aes(1, -rank, color=col)) + 
    geom_text(aes(label=senador),
              size=3) + 
    theme_void()+
    theme(legend.position = &quot;none&quot;)+
    scale_color_manual(values = c(&quot;orange&quot;, &quot;red&quot;))

  plot_grid(p, inset, align=&quot;h&quot;, rel_widths = c(2,1))

  senadores %&gt;%
    count(reemplazo) %&gt;%
    arrange(desc(n)) %&gt;%
    head(n=10) %&gt;%
    knitr::kable(col.names = c(&quot;Reemplazante&quot;, &quot;Número de casos&quot;)) %&gt;%
    kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
                  full_width = FALSE)


# Calcular el numero de dias en el poder
dias_poder &lt;-  senadores %&gt;%
   mutate(cese_periodo_real = ifelse(cese_periodo_real==&quot;Sin Datos&quot;,
                                    as.character(today()),
                                    cese_periodo_real)) %&gt;%
  mutate_at(.vars = vars(cese_periodo_real,
                      inicio_periodo_real),
              .funs =  list(ymd)) %&gt;%
    # Calcular diferencia de dias
    mutate(dias = cese_periodo_real - inicio_periodo_real) %&gt;%
    # group_by(senador, provincia) %&gt;%
    group_by(senador) %&gt;%
    # sumar dias por senador
    summarise(desde = min(inicio_periodo_real),
              hasta = max(cese_periodo_real),
              total_dias = ymd(hasta) - ymd(desde),
              total_mandato = as.numeric(sum(dias))) %&gt;%
    filter(senador != &quot;,&quot;) %&gt;%
    arrange(desc(total_mandato))

# Hacer el ranking plot
part_plot &lt;- dias_poder %&gt;%
  ggplot(aes(as.numeric(fct_reorder(senador, total_mandato)), y=total_mandato)) +
  geom_point(color=&quot;gray70&quot;)+
  theme_bw()+
#  xlim(c(0, nrow(senadores))+
  theme(axis.text.x =element_blank(),
        axis.ticks.x = element_blank(),
        legend.position = &quot;none&quot;,
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank())+
  labs(x=&quot;Senadores según número de orden.\nRanking ascendente&quot;,
       y=&quot;Días de Mandato&quot;,
       title=&quot;Ranking de Senadores&quot;,
       subtitle=my_twitter,
       caption= my_caption) 

reg &lt;- dias_poder %&gt;%
  arrange(total_mandato) %&gt;%
  mutate(orden = 1:length(senador)) %&gt;% 
  select(total_mandato, orden)

# Con los nombres
part_plot +
  ggrepel::geom_label_repel(data=head(dias_poder, 5),
                            aes(x=tail(reg$orden, 5),
                                label=senador),
                            xlim = c(NA, nrow(senadores) - 400),
                            force=10,
                            segment.color = &quot;black&quot;)




# Pareciera una funcion partida
piece_wise &lt;- segmented::segmented(lm(total_mandato ~ orden, data=reg))
coef_piece &lt;- coefficients(piece_wise)
break_point &lt;- piece_wise$psi[,2]
new_zero &lt;- predict(piece_wise, newdata = data.frame(orden = break_point))
new &lt;- data.frame(orden = c(break_point, break_point + 1),
           total_mandato = c(new_zero, predict(piece_wise, data.frame(orden = break_point + 1))))

new_lm &lt;- lm(data= new, total_mandato ~ orden)

# Plot con el ajuste
part_plot +
  # Add the line using the fortified fit data, plotting the x vs. the fitted values
  # ggplot() +
  # geom_line(data = fortify(piece_wise), aes(x = orden, y = .fitted))+
  geom_vline(xintercept = break_point, lty=3)+
  geom_abline(intercept = coef_piece[1],
              slope = coef_piece[2],
              col=RColorBrewer::brewer.pal(3, &quot;Set1&quot;)[1],
              lwd=0.8)+
  geom_abline(intercept = coefficients(new_lm)[1],
              slope = coefficients(new_lm)[2],
              col=RColorBrewer::brewer.pal(3, &quot;Set1&quot;)[2],
              lwd=0.8)+
  geom_hline(yintercept = seq(0, 365 * 40, 365*10), lty=2, color=&quot;gray50&quot;)+
  annotate(&quot;text&quot;, x=100, y=365*10 + 500, label=&quot;10 años&quot;)+
  annotate(&quot;text&quot;, x=break_point - 100, y = 13000,
           label=&quot;punto de \nquiebre&quot;) 


# crear una lista de los senadores para grafica segun los tiempos
top_sen &lt;- dias_poder %&gt;%
  top_n(total_mandato, n = 60) %&gt;%
  pull(senador)


segment_plot_df &lt;- filter(senadores, senador %in%  top_sen) %&gt;%
  left_join(dplyr::select(dias_poder, senador, total_mandato), by=&quot;senador&quot;) %&gt;%
mutate(cese_periodo_real = ifelse(cese_periodo_real==&quot;Sin Datos&quot;,
                                  as.character(today()),
                                  cese_periodo_real)) 
  
ggplot(segment_plot_df,
       aes(x=fct_reorder(senador, total_mandato),
           y=ymd(cese_periodo_real),
           color=partido_politico))+
  geom_segment(aes(xend=senador,
                   y=ymd(inicio_periodo_real),
                   yend=ymd(cese_periodo_real)),
               lwd=2)+
  coord_flip()+
#  facet_wrap(~provincia, scales=&quot;free_y&quot;)+
  theme(axis.text.y=element_blank(),
        axis.ticks.y = element_blank(),
        legend.position = &quot;none&quot;,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill=&quot;gray30&quot;))+
#  geom_rect(data=NULL,
#            ymin=ymd(&quot;1976-03-24&quot;),
#            ymax=ymd(&quot;1983-12-10&quot;),
#            xmin=0, xmax=Inf,
#            fill='red', color=NA, alpha=0.005)+
#  geom_rect(data=NULL,
#            ymin=ymd(&quot;1966-06-28&quot;),
#            ymax=ymd(&quot;1973-05-25&quot;),
#            xmin=0, xmax=Inf,
#            fill=&quot;red&quot;, color=NA, alpha=0.005)
  geom_hline(yintercept = ymd(&quot;1983-12-10&quot;), lty=2,
             color=&quot;gray90&quot;)+
  scale_color_viridis_d(option = &quot;B&quot;, direction = 1)+
  xlab(&quot;Senador&quot;) + ylab(&quot;&quot;)+
  labs(title = glue::glue(&quot;Top &quot;,
                          length(unique(segment_plot_df$senador)),
                          &quot; senadores según longitud de mandato.&quot;),
       subtitle= paste0(&quot;Color indica partido político. La línea punteada indica el último retorno a la democracia (1983).\n&quot;, my_twitter),
       caption= my_caption)


repetidores &lt;- count_by_sen %&gt;% filter(n&gt;1) %&gt;% pull(senador)

repetidores_ordenado &lt;- senadores %&gt;%
  mutate(year = year(inicio_periodo_real)) %&gt;% 
  arrange(year) %&gt;%
  dplyr::select(senador, year, partido_politico) %&gt;%
  mutate(nuevo = ifelse(senador %in% repetidores, &quot;Repite&quot;, &quot;Nuevo&quot;))

# This is the first time each senator was elected, even they repeted later
first_time &lt;- purrr::map(repetidores,
                         function(senador) min(which(str_detect(string=repetidores_ordenado$senador,
                                                                pattern = senador)))) %&gt;%
  unlist()

# Now go back to replace that in the data frame
repetidores_ordenado[first_time, &quot;nuevo&quot;] &lt;- &quot;Nuevo&quot;


repetidores_plot &lt;- repetidores_ordenado %&gt;%
  group_by(year) %&gt;%
  count(nuevo) %&gt;%
  ungroup()%&gt;% #mind the ungroup! complete does not work otherwise
  complete(year, nuevo, fill = list(n = 0)) %&gt;%
  group_by(year) %&gt;%
  mutate(total=sum(n), percent=n/total * 100 %&gt;% round(., 2))

p1 &lt;- ggplot(filter(repetidores_plot, year %in% seq(1929, 1963, 2)),
       aes(year, percent, color=nuevo)) +
  geom_area(aes(fill=nuevo)) + theme(legend.position=&quot;none&quot;)


p2 &lt;- ggplot(filter(repetidores_plot, year %in% seq(1981, 2017, 2)),
       aes(year, percent, color=nuevo)) +
  geom_area(aes(fill=nuevo)) + theme(legend.position=&quot;none&quot;)

p3 &lt;- ggplot(filter(repetidores_plot, year %in% seq(1929, 1963, 2)),
       aes(year, n, color=nuevo)) +
  geom_area(aes(fill=nuevo)) + theme(legend.position=&quot;none&quot;)

p4 &lt;- ggplot(filter(repetidores_plot, year %in% seq(1981, 2017, 2)),
       aes(year, n, color=nuevo)) +
  geom_area(aes(fill=nuevo)) + theme(legend.position=&quot;none&quot;)


cowplot::plot_grid(p1, p2, p3, p4, nrow = 2, ncol =2)


# Evolucion de partidos tradicionales

justicia_ucr &lt;- senadores %&gt;%
  filter(str_detect(partido_politico,
                    &quot;JUSTICIALISTA|UNIÓN CÍVICA RADICAL|
                    U. C. R&quot;))
  
justicia_ucr &lt;- justicia_ucr %&gt;%
  # Todas las facciones de la UCR van juntas
  mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;^U.&quot;),
                                   &quot;UNIÓN CÍVICA RADICAL&quot;, partido_politico),
         # todos los &quot;justicialistas juntos&quot;
         partido_politico = ifelse(str_detect(partido_politico, &quot;JUSTICIA&quot;),
                                   &quot;JUSTICIALISTA&quot;, partido_politico),         
         year = year(inicio_periodo_legal)) %&gt;%
  group_by(year) %&gt;%
  count(partido_politico) %&gt;%
  mutate(total_year = sum(n), 
         proportion = n/total_year)

  
  ggplot(justicia_ucr,
         aes(year, n, fill=partido_politico))+
  geom_area(alpha=0.8) +
#  geom_point()+
  facet_wrap(~partido_politico)+
#  guides(fill=guide_legend(nrow=2,byrow=TRUE))+
  scale_fill_brewer(palette = &quot;Set1&quot;)+
#  geom_text(data=filter(justicia_ucr, year %in% c(1983, 2001)),
#            aes(year, n+5, label=n))
  theme_bw()+
  xlab(&quot;&quot;) + ylab(&quot;Número de Bancas&quot;)+  
  theme(legend.position = &quot;none&quot;)+
  labs(title = &quot;Partidos Tradicionales&quot;,
       subtitle = paste0(&quot;Partidos que se identifican como Justicialistas por su nombre fueron agrupados.\nPartidos que se identifican con la UCR por su nombre fueron agrupados.\n&quot;, my_twitter),
       caption= my_caption)+
  NULL

# Estos senadores fueron senadores por mas de una provincia

group_by(senadores, senador) %&gt;%
  count(provincia) %&gt;%
  distinct(senador, provincia) %&gt;%
  count(senador) %&gt;%
  filter(n &gt; 1) %&gt;%
  knitr::kable(col.names = c(&quot;Senador&quot;, &quot;Número de provincias&quot;)) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
                  full_width = FALSE)

group_by(senadores, senador) %&gt;%
  count(partido_politico) %&gt;%
  distinct(senador, partido_politico) %&gt;%
  count(senador) %&gt;%
  filter(n &gt; 1) %&gt;%
  knitr::kable(col.names = c(&quot;Senador&quot;, &quot;Número de partidos&quot;)) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
                  full_width = FALSE)

total_partidos &lt;- senadores %&gt;%
  summarise(partidos = length(unique(partido_politico))) %&gt;%
  pull(partidos)


senadores %&gt;%
  mutate(
    year = year(inicio_periodo_legal),
    etapa = ifelse(year &gt; 2001, &quot;post-2001&quot;, &quot;pre-2001&quot;)) %&gt;%
  group_by(etapa) %&gt;%
  summarise(partidos_unicos = length(unique(partido_politico)))%&gt;%
  arrange(partidos_unicos) %&gt;%
  knitr::kable(col.names = c(&quot;Etapa&quot;, &quot;Número de partidos&quot;)) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
                  full_width = FALSE)
  
senadores %&gt;%
  # TODO JUSTICIALISTA
  mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;JUSTICIALISTA&quot;),
                                   &quot;JUSTICIALISTA&quot;, partido_politico))%&gt;%
  # Todo FPV
  mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;FRENTE PARA LA VICTORIA&quot;),
                                   &quot;FRENTE PARA LA VICTORIA&quot;, partido_politico))%&gt;%
  # TODO PRO
  mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;UNIÓN PRO|CAMBIEMOS&quot;),
                                   &quot;PRO -- CAMBIEMOS&quot;, partido_politico))%&gt;%
  # Todas las facciones de la UCR van juntas
  mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;^U.&quot;),
                                   &quot;UNIÓN CÍVICA RADICAL&quot;, partido_politico)) %&gt;%
  mutate(
    year = year(inicio_periodo_legal),
    etapa = ifelse(year &gt; 2001, &quot;post-2001&quot;, &quot;pre-2001&quot;)) %&gt;%
  group_by(etapa) %&gt;%
  summarise(partidos_unicos = length(unique(partido_politico)))%&gt;%
  knitr::kable(col.names = c(&quot;Etapa&quot;, &quot;Número de partidos&quot;)) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
                  full_width = FALSE)

  post_2001 &lt;- senadores %&gt;%
    mutate(year = year(inicio_periodo_legal)) %&gt;%
    filter(year &gt; 2001) %&gt;%
    # TODO JUSTICIALISTA
    mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;JUSTICIALISTA&quot;),
                                     &quot;JUSTICIALISTA&quot;, partido_politico))%&gt;%
    # Todo FPV
    mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;FRENTE PARA LA VICTORIA&quot;),
                                     &quot;FRENTE PARA LA VICTORIA&quot;, partido_politico))%&gt;%
    # TODO PRO
    mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;UNIÓN PRO|CAMBIEMOS&quot;),
                                     &quot;PRO -- CAMBIEMOS&quot;, partido_politico))%&gt;%
    group_by(year) %&gt;%
    count(partido_politico) %&gt;%
    mutate(total_year = sum(n), 
           proportion = n/total_year)
  ggplot(filter(post_2001, n&gt;3) %&gt;% mutate(partido_politico = factor(partido_politico, levels = c(&quot;JUSTICIALISTA&quot;, &quot;UNIÓN CÍVICA RADICAL&quot;, &quot;FRENTE PARA LA VICTORIA&quot;, &quot;PRO -- CAMBIEMOS&quot;))),
         aes(year, n, fill=partido_politico, color=partido_politico))+
    geom_area(alpha=0.8) +
    geom_point()+
    facet_wrap(~partido_politico)+
    #  guides(fill=guide_legend(nrow=2,byrow=TRUE))+
    scale_fill_brewer(palette = &quot;Set1&quot;)+
    scale_color_brewer(palette = &quot;Set1&quot;)+
    #  geom_text(data=filter(justicia_ucr, year %in% c(1983, 2001)),
    #            aes(year, n+5, label=n))
    theme_bw()+
    xlab(&quot;&quot;) + ylab(&quot;Número de Bancas&quot;)+  
    theme(legend.position = &quot;none&quot;)+
    labs(title = &quot;Post 2001&quot;,
         subtitle = paste0(&quot;Partidos politicos agrupados en categorías según uso de terminos en el nombre oficial.\n&quot;, my_twitter),
         caption= my_caption)  +
  NULL


partidos &lt;- senadores %&gt;%
  mutate(partido_politico = str_replace(partido_politico, &quot;U. C. R.&quot;, &quot;UCR&quot;)) %&gt;%
  filter(partido_politico != &quot;SIN ESPECIFICAR&quot;) %&gt;%
  pull(partido_politico)  
partidos &lt;- unlist(str_split(partidos, ' '))

# common words
custom_stop_words &lt;- bind_rows(stop_words,
                               tibble(word = tm::stopwords(&quot;spanish&quot;),
                                      lexicon = &quot;custom&quot;))

# tokenize
tokens &lt;- data.frame(word = partidos, stringsAsFactors = FALSE) %&gt;% 
  unnest_tokens(word, word) %&gt;% 
  anti_join(custom_stop_words) %&gt;%
  dplyr::count(word, sort = TRUE) %&gt;% 
  ungroup()

# define a nice color palette
pal &lt;- brewer.pal(8,&quot;Dark2&quot;)

# Check for wordcloud

wordcloud_file &lt;- &quot;senadores_wordcloud.png&quot;

if(!file.exists(wordcloud_file)){
# plot the 50 most common words
devtools::source_url(&quot;https://raw.githubusercontent.com/matiasandina/stepfinder/master/R/open_graphic_window.R&quot;)
open_graphic_window()
tokens %&gt;% 
  with(wordcloud(word, n,
                 random.order = FALSE,
                 max.words = 50, colors=pal))

  savePlot(filename = &quot;senadores_wordcloud.png&quot;,
           type = c(&quot;png&quot;),
           device = dev.cur())
  
}


repetidores &lt;- senadores %&gt;% count(senador) %&gt;% filter(n &gt; 1) %&gt;% pull(senador)

library(ggraph)
library(tidygraph)

graph &lt;- senadores  %&gt;% filter(senador %in% repetidores) %&gt;%
  filter(partido_politico != &quot;SIN ESPECIFICAR&quot;) %&gt;%
  # Todas las facciones de la UCR van juntas
  mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;^U.&quot;),
                                   &quot;UNIÓN CÍVICA RADICAL&quot;, partido_politico))%&gt;%

    # TODO JUSTICIALISTA
    mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;JUSTICIALISTA&quot;),
                                     &quot;JUSTICIALISTA&quot;, partido_politico))%&gt;%
    # Todo FPV
    mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;FRENTE PARA LA VICTORIA&quot;),
                                     &quot;FRENTE PARA LA VICTORIA&quot;, partido_politico))%&gt;%
    # TODO PRO
    mutate(partido_politico = ifelse(str_detect(partido_politico, &quot;UNIÓN PRO|CAMBIEMOS&quot;),
                                     &quot;PRO -- CAMBIEMOS&quot;, partido_politico))%&gt;%
  dplyr::select(senador, partido_politico) %&gt;%
  as_tbl_graph() %&gt;%
mutate(Popularity = centrality_degree(mode = 'in'))

graph &lt;- graph %&gt;%
  activate(nodes) %&gt;% # use dplyr on nodes
  mutate(my_color = 
           ifelse(name %in% repetidores, &quot;black&quot;, &quot;partido&quot;),
         partido_grande = ifelse(Popularity &gt; 3 &amp; my_color == &quot;partido&quot;, name, &quot;Otro (incluye senadores)&quot;)
  ) 

set.seed(123)
ggraph(graph, layout = 'auto') + 
    geom_edge_fan(aes(alpha = stat(index)), show.legend = FALSE) + 
    geom_node_point(aes(size = Popularity * 10, color=partido_grande)) + 
  scale_color_viridis_d(option = &quot;A&quot;)+
  theme(legend.position = &quot;bottom&quot;)+
#  guides(color=guide_legend(nrow=3, byrow=TRUE), size=FALSE)
  guides(color=guide_legend(title = &quot;&quot;, nrow = 4, ncol=4), size=FALSE)+
  theme(panel.background = element_rect(fill=&quot;gray30&quot;),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank(),
        legend.background = element_rect(fill=&quot;gray30&quot;, size=.5),
        legend.key = element_rect(fill = &quot;gray30&quot;, color=NA),
        legend.text = element_text(color = &quot;white&quot;),
        legend.title = element_text(color = &quot;white&quot;))
#    facet_edges(~year) + 
#    theme_graph(foreground = 'steelblue', fg_text_colour = 'white')


diputados %&gt;%
  group_by(diputado_genero) %&gt;%
  count() %&gt;%
  knitr::kable(col.names = c(&quot;Género&quot;, &quot;Número de diputados&quot;)) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
                  full_width = FALSE)


genero &lt;- diputados %&gt;%
  mutate(year = year(mandato_inicio))%&gt;%
  group_by(year) %&gt;%
  count(diputado_genero) %&gt;%
  mutate(total = sum(n), ratio = n/total)

p1 &lt;-  ggplot(genero, aes(year, n, color=diputado_genero))+
  geom_line()+
  geom_point(size=2)+
  scale_x_continuous(breaks=2007:2020)+
  theme_bw()+
  theme(legend.position=&quot;none&quot;)+
  scale_color_manual(values=c(&quot;#0096D6&quot;, &quot;gray25&quot;))+
  xlab(&quot;&quot;) + ylab(&quot;Número de bancas&quot;)+
  labs(title = &quot;Paridad de género en la Cámara de Diputados&quot;,
       subtitle = my_twitter)

p2 &lt;-  ggplot(genero,
              aes(year, ratio, fill=fct_rev(diputado_genero)))+
  #geom_line()+
  scale_x_continuous(breaks=2006:2017)+
  #geom_bar(stat=&quot;identity&quot;)+
  geom_area(color=&quot;black&quot;)+
  #geom_point(size=2)+
  theme_bw()+
  theme(legend.position=&quot;bottom&quot;)+
  labs(fill=&quot;Género&quot;)+
  geom_hline(yintercept = 0.5, lty=2, color=&quot;gray90&quot;)+
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
  ylab(&quot;Bancas (%)&quot;) + xlab(&quot;&quot;)+
  labs(caption = &quot;Fuente: datos.hcdn.gob.ar&quot;)+
  scale_fill_manual(values=c(&quot;gray25&quot;, &quot;#0096D6&quot;)) # &quot;#FFEF00&quot;))


plot_grid(p1,p2, nrow=2, align = &quot;v&quot;)
  
  
dip_partidos &lt;- diputados %&gt;%
  mutate(diputado_bloque = ifelse(str_detect(diputado_bloque, &quot;PRO&quot;), &quot;PRO -- UNIÓN PRO&quot;, diputado_bloque))%&gt;%
  group_by(diputado_bloque) %&gt;%
  count() %&gt;%
  arrange(desc(n)) %&gt;%
  ungroup()%&gt;%
  mutate(orden = 1:length(diputado_bloque))
  
  ggplot(dip_partidos,
         aes(rev(orden), n)) +
  geom_point(aes(color= n &gt;1)) +
#  theme(axis.text.y = element_blank(),
#        axis.ticks.y = element_blank(),
#        panel.grid.major.y = element_blank(),
#        panel.grid.minor.y = element_blank())+
  xlab(&quot;Número de orden.\nPartidos según bancas. Ranking ascendente.&quot;)+
  ylab(&quot;Número de bancas&quot;)+  
  labs(title = &quot;Desigualdad en la Cámara de Diputados.&quot;,
       subtitle = my_twitter,
       caption =  &quot;Fuente: datos.hcdn.gob.ar&quot;)+
  expand_limits(x = c(0, nrow(dip_partidos) + 2))+
  ggrepel::geom_label_repel(data=head(dip_partidos, 3),
                            aes(x=rev(tail(dip_partidos, 3)$orden), 
                               y= n, label=diputado_bloque),
                            ylim = c(50, 300),
                            direction = &quot;both&quot;,
                            force=1,
                           # angle=45,
                            segment.color = &quot;black&quot;)+
    theme_bw()+
    theme(legend.position = &quot;none&quot;)+
    annotate(&quot;text&quot;, x=20, xmin = 10, y=30, label=&quot;Partidos con un diputado&quot;)+
    scale_color_manual(values=c(&quot;#FFEF00&quot;, &quot;black&quot;))
</code></pre>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Desde Wikipedia a su pantalla: &ldquo;Los requisitos para ser elegidos senador son: tener la edad de treinta años, haber sido seis años ciudadano de la Nación, y ser natural de la provincia que lo elija, o con dos años de residencia inmediata en ella.&rdquo;&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>Ni hablar de una coronaria a corazón abierto, no?&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>Cuando digo <em>apolíticos</em> no me refiero a sus conviciones personales e inclinaciones políticas. Al menos en mi mente, el funcionamiento interno de ciertas dependencias del Estado debe ser autónomo. Un dato es un dato (sea la masa de un átomo o el desempleo), un docente o un estadísta del INDEC no deberían estar afectados en su labor por el partido de turno.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>Incluso en estas circunstancias, no considero que los investigadores o los maestros deban estar haciendo siempre la misma tarea. Al contrario, sendos gremios deberían funcionar con una estructura que permita aprovechar la experiencia para el mejor funcionamiento en vez de promover una jerarquía absurda por la jerarquía misma. Una científica jóven quizás esté mejor capacitada para hacer experimentos con sus propias manos. Un maestro jóven para interactuar con alumnos sin que haya un salto generacional muy pronunciado. Aquellos que tengan mayor experiencia, quizás pueda impulsar cambios estructurales para mejorar aspectos que no estén funcionando.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5" role="doc-endnote">
<p>Para simplificar, elegí partidos que lograron obtener más de 3 bancas.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="/tags/r/">R</a></span>
        <span class="tag"><a href="/tags/learning/">learning</a></span>
        
    </p>

            
			    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="c23fcc34ca4e223a9f89a3d7a6141683a1228202" target="_blank" rel="noopener">c23fcc3</a> @ 2021-02-15</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            <span><a href="/">Matias Andina</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span><span><a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        




 <script type="text/javascript" src="/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js"></script>



    </body>
</html>
