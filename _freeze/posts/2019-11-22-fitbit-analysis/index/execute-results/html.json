{
  "hash": "7a55e233debc2cc1181a6504b4ac4558",
  "result": {
    "markdown": "---\ntitle: \"Fitbit Analysis\"\ndate: 2019-11-22\ntags: [\"tracking\",\"learning\", \"R\"]\n---\n\n\nIt's been a bit more than a year since I got a fitbit and I have been pretty excited about tracking my activity and heart rate. I should say I'm quite surprised about the sleep data. Tracking sleep has been, in fact, the most exciting feature, and I now strive to get at least 7 hours of sleep per night.\n\n\n\n\n\n\n::: {.cell hash='index_cache/html/read-data_b19f6c273d7cda4388512821dade5132'}\n\n:::\n\n\nLet's first see a glimpse of the data, just to know what type of data we are dealing with. \n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_449d71aadc60365c95379d226147e553'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 8\n  date_time           dateTime   dataset_time variable value total_value\n  <dttm>              <date>     <time>       <chr>    <dbl>       <dbl>\n1 2018-06-10 00:00:00 2018-06-10 00'00\"       steps        0        7256\n2 2018-06-10 00:01:00 2018-06-10 01'00\"       steps        8        7256\n3 2018-06-10 00:02:00 2018-06-10 02'00\"       steps        0        7256\n4 2018-06-10 00:03:00 2018-06-10 03'00\"       steps        0        7256\n5 2018-06-10 00:04:00 2018-06-10 04'00\"       steps        0        7256\n# ℹ 2 more variables: date <date>, time <time>\n```\n:::\n:::\n\n\n## Density plots\n\nLet's now inspect the overall distribution for heart rate and step values.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_7f262ef97126c97a9f9b5ff7195a56e8'}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n## When do I move?\n\nI will start by focusing on the data for steps.\n\nI'm curious to see what times of the day have the most activity. Because I have a quite large amount of data points (~751 K) I will use `geom_hex()` to count for me and simplify rendering[^searching].\n\n[^searching]: I had been searching for excuses to use this function for a while. Check it out [here](https://ggplot2.tidyverse.org/reference/geom_hex.html)\n\n\n::: {.cell hash='index_cache/html/steps-1_8d6c71e6ad4638b0de99fb1db91cc53b'}\n::: {.cell-output-display}\n![](index_files/figure-html/steps-1-1.png){width=672}\n:::\n:::\n\n\nWell, I should have remembered that for the vast majority of minutes (regardless of the hour of the day), the count is exactly zero. Let's only look at the positive counts:\n\n\n::: {.cell hash='index_cache/html/steps-2_ad7004a8e0bb2c9104f43a69ad49a0af'}\n::: {.cell-output-display}\n![](index_files/figure-html/steps-2-1.png){width=672}\n:::\n:::\n\n\nWe see now some patches that have high activity (> 100 steps), particularly around 9:00, 12:00 and 18:00. These mostly correspond to \"going to work\", \"activity around lunch time (?)\", and \"going home / physical activity\". For all other cases, it looks like I move around 10-20 steps per minute, regardless of the minute within the hour.\n\n\n### Last 10 minutes\n\nThe result above is interesting because I usually have to be reminded by Fitbit to \"move up to 250 steps in the hour\". I receive this notification during the last 10 minutes of the hour and I would think that during those 10 minutes I put more steps than during the first 50. The data show I'm wrong:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/last-10-plot-1.png){width=672}\n:::\n:::\n\n\nThat being said, I want to keep my reminder on. I feel like having it turned on definitely adds ~ 1000-2000 steps per day.\n\n### Daily average\n\nLet's get one level above and aggregate each day as a unit. This plot shows a nice trend, with months from May to August showing an increase on the number of steps. Keep in mind that November will show little average steps because for that month we have incomplete data (last day in database is 2019-11-13),  \n\n\n::: {.cell hash='index_cache/html/steps-3_71a509a22fe214d601e90217c476bdc1'}\n::: {.cell-output-display}\n![](index_files/figure-html/steps-3-1.png){width=672}\n:::\n:::\n\n\nAt this part of the analysis, I should make clear that I took vacations from `2019-06-27` to `2019-07-11`. We will use this information in the analysis to make some things clear.\n\n\n::: {.cell}\n\n:::\n\n\n\n## Distribution\n\nWe looked at the average daily steps for each month, how about the distribution of daily steps? We see that most days I come quite close to the default target of 10K steps. There are some days with very little steps (see below) and, obviously, some days with extreme number of steps.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/typical-events-1.png){width=672}\n:::\n:::\n\n\n## Extreme events\n\nUsing the boxplot below, we can define *extreme events* as instances where I walked more than 20K steps. I chose to plot this by day of the week, to get an insight about periodicity of events.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nBecause I walked a lot during the vacations, I highlighted the days on top of the previous boxplot. Most of the extreme events are definitely during the vacations. Moreover, none of the days I walked less than 10K steps, pretty amazing!\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/vacations-2-1.png){width=672}\n:::\n:::\n\n\n\nThere are some extreme *low* events, these are quite likely the days I just don't wear the fitbit (or days I forget to wear it for most of the day). Just because I can order the data and make another plot, I went ahead and did it!\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/arranged-steps-1.png){width=672}\n:::\n:::\n\n\n\nWe usually go for walks on Saturdays and/or Sundays. Knowing this little piece of data, it's quite expected to see Saturdays being the days with higher number of steps (and hence higher success rate on the 10K target). \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Season\n\nI want to turn the focus now to the seasonality of the data. I will use a helper function `getSeason()` that I took from [StackOverflow](https://stackoverflow.com/questions/9500114/find-which-season-a-particular-date-belongs-to).\n\n\n::: {.cell}\n\n:::\n\n\nWe can inspect the effect of season on my walking.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nThe plot above is not good, it fails to communicate. I think this is a better way to show the data. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n## A year's heart rate in one plot\n\nI'm borrowing **heavily** from [Nick](https://livefreeordichotomize.com/2017/12/27/a-year-as-told-by-fitbit/) here. But I thought it was a brilliant plot, so I took it for a ride with my data. I actually changed a few things, I decided to keep the native sampling rate and use `geom_line()` instead of down-sampling and using `geom_tile()`. The overall trend is clear, movements during the morning and the afternoon that correlate well with going and coming back from work. Somewhere around July 2019 you can see the change in timezone when I took vacations. There are a couple of days in late May with continuously high or lacking values, I take this as one of the days I forgot the fitbit at home, likely spurious measures. \n\n\n::: {.cell}\n\n:::\n\n\n![](heart_plot.png)\n\n## Code\n\nThe code for this post is quite long and I thought it would get in the way. I am happy to share upon request, hit me up on [Twitter](https://twitter.com/NeuroMLA) or in the comments below.\n\n## Sources\n\n* https://livefreeordichotomize.com/2017/12/27/a-year-as-told-by-fitbit/\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}